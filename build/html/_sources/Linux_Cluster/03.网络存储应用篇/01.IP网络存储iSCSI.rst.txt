.. contents::
   :depth: 3
..

01.IP网络存储iSCSI
==================

iSCSI技术以其低廉的构建成本和优秀
的存储性能，博得了很多CIO和存储管理员的喜爱，目前陆续进入企业应用领域，推
动了企业的存储环境向集中式转变。虽然，目前对于iSCSI应该在什么样的环境中使
用还存在着诸多争议，但是iSCSI的前途是光明的，在未来的存储世界中，iSCSI一
定会占据重要的席位。

存储的概念与术语
----------------

在存储的世界里，有各种各样的名词和术语，常见的有SCSI、FC、DAS、NAS、SAN
等。

SCSI介绍
~~~~~~~~

::

    SCSI是小型计算机系统接口（Small Computer System Interface）的简称，
    SCSI作为输入/输出接口，主要用于硬盘、光盘、磁带机、扫描仪、打印机等设备。

FC介绍
~~~~~~

::

    FC是光纤通道（Fibre Channel）的简称，是一种适合于千兆数据传输的、成熟而安全的解决方案。与传统的SCSI技术相比，FC提供更高的数据传输速率，更远的传
    输距离，更多的设备连接支持，更稳定的性能，更简易的安装。

DAS介绍
~~~~~~~

::

    DAS是直连式存储（Direct-Attached Storage）的简称，
    是指将存储设备通过SCSI接口或光纤通道直接连接到一台计算机上。当服务器在地理上比较分散，很难通过远程进行互连时，DAS是比较好的解决方案。但是这种式存储只能通过与之连接
    的主机进行访问，不能实现数据与其他主机的共享，同时，DAS会占用服务器操作系统资源，例如CPU资源、IO资源等，并且数据量越大，占用操作系统资源就越严重。

NAS介绍
~~~~~~~

::

    网络接入存储（Network-Attached Storage）简称NAS，
    它通过网络交换机连接存储系统和服务器，建立专门用于数据存储的私有网络，用户通过TCP/IP协议访问数据，采用业界标准的文件共享协议如NFS、HTTP、CIFS来实现基于文件级的数据
    共享。NAS存储使文件共享访问变得更方便和快捷，并且能很容易地增加存储容量。通过专业化的文件服务器与存储技术相结合，
    NAS为那些需要共享大量文件数据的企业提供了一个高效的、高可靠的、高性价比的解决方案。但是NAS也有一定的局限性，它会受到网络带宽和网络拥堵的影响，在一定程度上限制了NAS的网络传输能力。

SAN介绍
-------

::

    存储区域网络（Storage Area Network）简称SAN，它是一种通过光纤交换机、光纤路由器、光纤集线器等设备将磁盘阵列、磁带等存储设备与相关服务器连接起来的高速专用子网。

    SAN由3个部分组成，
    分别是连接设备（如路由器、光纤交换机和Hub）、
    接口（如SCSI、FC）
    通信协议（如IP和SCSI）。


    这3个部分再加上存储设备和服务器就构成了一个SAN系统。SAN提供了一个灵活的、高性能的和高扩展性的存储网络环境，
    它可以更加有效地传输海量的数据块。由于采用了光纤接口，因此SAN还具有更高的
    带宽，同时，SAN也使统一管理和集中控制实现简化。现在SAN已经广泛应用于ISP
    和银行等，随着用户业务量的增大，SAN的应用前景将越来越光明。

iSCSI的优势主要表现为：
~~~~~~~~~~~~~~~~~~~~~~~

::

    首先，iSCSI沿用TCP/IP协议，而TCP/IP是在网络方面最通用、最成熟的协议，
    且IP网络的基础建设非常完善，同时，SCSI技术是被磁盘和磁带等设备广泛采用的存储标准，这两点使iSCSI的建设费用和维护成本非常低
    廉；其次，iSCSI支持一般的以太网交换机而不是特殊的光纤通道交换机，从而减少
    了异构网络带来的麻烦；还有，iSCSI是通过IP封包传输存储命令，因此可以在整
    个Internet上传输数据，没有距离的限制。

FC SAN与IP SAN
~~~~~~~~~~~~~~

在iSCSI技术出现后，通过IP技术搭建的存储网络也应运而生，SAN技术也就出现了两种不同的实现方式，
即FC SAN与IP SAN。

简单来说，\ ``以光纤搭建的存储网络就是FC SAN，以iSCSI技术搭建的存储网络叫做IP SAN。``

作为SAN的两种实现方式，FC SAN与IP SAN各有优劣，下面从几个方面分别阐述。

::

    在数据传输方式上，FC SAN与IP SAN都采用块协议方式来完成。这是它们的相同点。

    在传输速度上，就目前的传输速率而言，FC SAN（2Gbit/s）最快，iSCSI（1Gbit/s）次之。

    在传输距离上，FC SAN理论上可以达到100公里，而事实上，传输超过50公里后，就会出现瓶颈。
    而通过IP网络的iSCSI技术在理论上没有距离的限制，即iSCSI可以进行没有距离限制的数据传输。

    在管理及维护成本上，架设FC SAN网络需要投入很多硬件成本，并且需要特定的工具软件进行操作管理，
    而IP SAN构建成本低廉，由于iSCSI是通过IP网络来传输数
    据和分配存储资源的，因此只要在现有的网络上进行管理和使用即可，
    这样就可以省下大笔的管理费用及培训成本。

    其实IP SAN也面临着一些不可回避的困扰：首先，基于IP SAN的网络存储还没有得
    到用户的充分肯定；其次，IP SAN存储需要专门的驱动和设备，幸运的是，一些传
    统的光纤适配器厂商都发布了iSCSI HBA设备，同时Inter也推出了专用的IP存储适
    配器，而Microsoft、HP、Novell、SUN、AIX、Linux也具有iSCSI Initiator软
    件，并且免费供用户使用；还有，在安全方面，IP SAN虽然有一套规范的安全机制，但是尚未得到用户的认可。

    这些问题和困扰虽然会妨碍iSCSI的发展，但是相信在未来的网络存储世界里，IP SAN绝对会拥有一席之地。

iSCSI的组成
-----------

一个简单的iSCSI系统大致由以下部分组成：

::

    iSCSI Initiator或者iSCSI HBA
    iSCSI Target
    以太网交换机
    一台或者多台服务器

.. figure:: ../../_static/ISCSI00001.PNG
   :alt: 

iSCSI服务器用来安装iSCSI驱动程序，即安装iSCSI Initiator；

Storage Router可以是以太网交换机或者路由器；

iSCSI存储设备可以是iSCSI磁盘阵列，也可以是具有存储功能的PC服务器。

搭建iSCSI网络存储示例的结构图如下：

.. figure:: ../../_static/ISCSI000002.PNG
   :alt: 

具体操作步骤：\ ``参见-Linux服务器架设《使用iSCSI服务部署网络存储》``
这篇文章。

在此不做拓展，动脑动手时间。

可以参考博客：

http://blog.linuxli.com/2019/07/ISCSI/
